"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[165],{30165:function(e,l,d){d.r(l);var i=d(85893),r=d(67294),t=d(8303),n=d(9473),a=d(49443),s=d(46236),o=d(98146),c=d(76649),u=d(52481);let h=e=>{var l,d,h,v,m,_,x,p,j,b,f,N,g,y,w,R,E,S,q,C,B,O,A,I,D,V,P,T,F,L,U,k,G,M,Q,H,W,Y,J;let{id:z}=e,K=(0,n.I0)(),{code:X}=(0,n.v9)(e=>e.util),{token:Z,user:$}=(0,n.v9)(e=>e.user),{loading:ee}=(0,n.v9)(e=>e.goodReceiveNote),{allGRNs:el}=(0,n.v9)(e=>e.goodReceiveNote),[ed,ei]=(0,r.useState)([]),[er,et]=(0,r.useState)({purchase_requisition_id:0,local_purchase_order_id:0,good_receive_note_id:0,bill_number:"",bill_amount:0,paid_amount:0,balance:0,created_by:$.id,updated_by:$.id}),[en,ea]=(0,r.useState)([]),[es,eo]=(0,r.useState)({}),[ec,eu]=(0,r.useState)(!1),[eh,ev]=(0,r.useState)(0),[em,e_]=(0,r.useState)(0),ex=e=>{if(e.preventDefault(),(0,t.uB)(Z),z);else{let l={...er,bill_amount:eh};K((0,o.NS)(l))}},ep=e=>{e&&void 0!==e?(et(l=>({...l,paid_amount:e.target.value,balance:eh-e.target.value})),e_(eh-parseFloat(e.target.value))):(et(e=>({...e,paid_amount:0,balance:eh})),e_(eh))},ej=e=>{if(e&&void 0!==e){var l;console.log(e),et(l=>({...l,good_receive_note_id:e.value,purchase_requisition_id:e.grn.purchase_requisition_id,local_purchase_order_id:e.grn.local_purchase_order_id})),eo(e.grn),eu(!0),(null===(l=e.grn.items)||void 0===l?void 0:l.length)>0&&ei(l=>e.grn.items.map(e=>{var l;return{raw_product_id:e.raw_product_id,raw_product_title:e.raw_product.title+" ("+e.raw_product.item_code+")",quantity:parseInt(e.quantity),received_quantity:parseInt(e.received_quantity),unit_id:e.unit_id,unit_title:e.unit.short_name,unit_price:parseFloat(e.unit_price),total:parseFloat(e.unit_price)*parseInt(e.quantity),description:e.description||"",tax_category_name:null===(l=e.tax_category)||void 0===l?void 0:l.name,tax_category_id:e.tax_category_id,tax_rate:e.tax_rate,tax_amount:e.tax_amount,row_total:e.unit_price*e.quantity}}))}else et(e=>({...e,good_receive_note_id:0,purchase_requisition_id:0,local_purchase_order_id:0})),eo({}),ei([]),eu(!1)};return(0,r.useEffect)(()=>{K((0,o.aW)()),(0,t.uB)(Z),(0,t.OG)("application/json"),K((0,s.oJ)()),eu(!1),K((0,c.ge)()),K((0,c.bB)(u.q.VENDOR_BILL))},[]),(0,r.useEffect)(()=>{X&&et(e=>({...e,bill_number:X}))},[X]),(0,r.useEffect)(()=>{el&&ea(el.map(e=>({value:e.id,label:e.grn_number,grn:e})))},[el]),(0,r.useEffect)(()=>{ev(ed.reduce((e,l)=>e+l.row_total,0))},[ed]),(0,i.jsx)("form",{className:"space-y-5",onSubmit:e=>ex(e),children:(0,i.jsxs)("div",{className:"flex justify-start flex-col items-start space-y-3",children:[(0,i.jsxs)("div",{className:"w-full md:w-1/2",children:[(0,i.jsx)("label",{htmlFor:"purchase_requisition_id",children:"Good Receive Note"}),(0,i.jsx)(a.default,{defaultValue:en[0],options:en,isSearchable:!0,isClearable:!0,placeholder:"Select Good Receive Notes",onChange:e=>ej(e)})]}),(0,i.jsxs)("div",{className:"w-full md:w-1/2",children:[(0,i.jsx)("label",{htmlFor:"bill_number",children:"Vendor Bill Number"}),(0,i.jsx)("input",{type:"text",className:"form-input",placeholder:"Vendor Bill Number",name:"bill_number",value:er.bill_number,disabled:!0,onChange:e=>et(l=>({...l,bill_number:e.target.value}))})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 w-full",children:[(0,i.jsxs)("div",{className:"w-full",children:[(0,i.jsx)("label",{htmlFor:"bill_number",children:"Bill Amount"}),(0,i.jsx)("input",{type:"number",className:"form-input",placeholder:"Vendor Bill Number",name:"bill_number",value:eh,disabled:!0,onChange:e=>ev(parseFloat(e.target.value))})]}),(0,i.jsxs)("div",{className:"w-full",children:[(0,i.jsx)("label",{htmlFor:"paid_amount",children:"Bill Paid Amount"}),(0,i.jsx)("input",{type:"number",className:"form-input",placeholder:"Paid Amount",name:"paid_amount",value:er.paid_amount,onChange:e=>ep(e)})]}),(0,i.jsxs)("div",{className:"w-full",children:[(0,i.jsx)("label",{htmlFor:"bill_number",children:"Balance Amount"}),(0,i.jsx)("input",{type:"number",className:"form-input",placeholder:"Balance Amount",name:"balance",disabled:!0,value:er.balance,onChange:e=>{et(l=>({...l,balance:eh-e.target.value}))}})]})]}),(0,i.jsxs)("div",{hidden:!ec,className:"w-full space-y-3",children:[(0,i.jsxs)("div",{className:"border rounded p-5 w-full",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold",children:"Good Receive Note Details"}),(0,i.jsx)("hr",{className:"my-3"}),(0,i.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 w-full my-5",children:[(0,i.jsxs)("div",{className:"w-full",children:[(0,i.jsx)("strong",{children:"Requisition Number: "}),(0,i.jsx)("span",{children:null===(l=es.purchase_requisition)||void 0===l?void 0:l.pr_code})]}),(0,i.jsxs)("div",{className:"w-full",children:[(0,i.jsx)("strong",{children:"LPO Number: "}),(0,i.jsx)("span",{children:null===(d=es.local_purchase_order)||void 0===d?void 0:d.lpo_number})]}),(0,i.jsxs)("div",{className:"w-full",children:[(0,i.jsx)("strong",{children:"Internal Document Number: "}),(0,i.jsx)("span",{children:null===(h=es.local_purchase_order)||void 0===h?void 0:h.internal_document_number})]}),(0,i.jsxs)("div",{className:"w-full",children:[(0,i.jsx)("strong",{children:"Purchase By: "}),(0,i.jsx)("span",{children:null===(v=es.local_purchase_order)||void 0===v?void 0:null===(m=v.purchased_by)||void 0===m?void 0:m.name})]}),(0,i.jsxs)("div",{className:"w-full",children:[(0,i.jsx)("strong",{children:"Received By: "}),(0,i.jsx)("span",{children:null===(_=es.received_by)||void 0===_?void 0:_.name})]}),(0,i.jsxs)("div",{className:"w-full",children:[(0,i.jsx)("strong",{children:"Shipped Via: "}),(0,i.jsx)("span",{children:(null===(x=es.local_purchase_order)||void 0===x?void 0:null===(p=x.vehicle)||void 0===p?void 0:p.name)+"-"+(null===(j=es.local_purchase_order)||void 0===j?void 0:null===(b=j.vehicle)||void 0===b?void 0:b.make)+" ("+(null===(f=es.local_purchase_order)||void 0===f?void 0:null===(N=f.vehicle)||void 0===N?void 0:N.number_plate)+")"})]})]}),(0,i.jsx)("hr",{className:"my-3"}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,i.jsxs)("div",{className:"table-responsive",children:[(0,i.jsx)("h4",{className:"font-bold text-lg",children:"Vendor Details"}),(0,i.jsxs)("table",{children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"Vendor Number"}),(0,i.jsx)("th",{children:"Vendor Name"}),(0,i.jsx)("th",{children:"Billed From"}),(0,i.jsx)("th",{children:"Shift From"})]})}),(0,i.jsx)("tbody",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:null===(g=es.local_purchase_order)||void 0===g?void 0:null===(y=g.vendor)||void 0===y?void 0:y.vendor_number}),(0,i.jsx)("td",{children:null===(w=es.local_purchase_order)||void 0===w?void 0:null===(R=w.vendor)||void 0===R?void 0:R.name}),(0,i.jsx)("td",{children:null===(E=es.local_purchase_order)||void 0===E?void 0:null===(S=E.vendor)||void 0===S?void 0:null===(q=S.addresses)||void 0===q?void 0:q.map((e,l)=>{if("billing"===e.type){var d,i,r;return e.address+", "+(null===(d=e.city)||void 0===d?void 0:d.name)+", "+(null===(i=e.state)||void 0===i?void 0:i.name)+", "+(null===(r=e.country)||void 0===r?void 0:r.name)}})}),(0,i.jsx)("td",{children:null===(C=es.local_purchase_order)||void 0===C?void 0:null===(B=C.vendor)||void 0===B?void 0:null===(O=B.addresses)||void 0===O?void 0:O.map((e,l)=>{if("shifting"===e.type){var d,i,r;return e.address+", "+(null===(d=e.city)||void 0===d?void 0:d.name)+", "+(null===(i=e.state)||void 0===i?void 0:i.name)+", "+(null===(r=e.country)||void 0===r?void 0:r.name)}})})]})})]})]}),(0,i.jsxs)("div",{className:"table-responsive",children:[(0,i.jsx)("h4",{className:"font-bold text-lg",children:"Representative Details"}),(0,i.jsxs)("table",{children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"Name"}),(0,i.jsx)("th",{children:"Phone"}),(0,i.jsx)("th",{children:"Email"}),(0,i.jsx)("th",{children:"Address"})]})}),(0,i.jsx)("tbody",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:null===(A=es.local_purchase_order)||void 0===A?void 0:null===(I=A.vendor_representative)||void 0===I?void 0:I.name}),(0,i.jsx)("td",{children:null===(D=es.local_purchase_order)||void 0===D?void 0:null===(V=D.vendor_representative)||void 0===V?void 0:V.phone}),(0,i.jsx)("td",{children:null===(P=es.local_purchase_order)||void 0===P?void 0:null===(T=P.vendor_representative)||void 0===T?void 0:T.email}),(0,i.jsx)("td",{children:(null===(F=es.local_purchase_order)||void 0===F?void 0:null===(L=F.vendor_representative)||void 0===L?void 0:L.address)+", "+(null===(U=es.local_purchase_order)||void 0===U?void 0:null===(k=U.vendor_representative)||void 0===k?void 0:null===(G=k.city)||void 0===G?void 0:G.name)+", "+(null===(M=es.local_purchase_order)||void 0===M?void 0:null===(Q=M.vendor_representative)||void 0===Q?void 0:null===(H=Q.state)||void 0===H?void 0:H.name)+", "+(null===(W=es.local_purchase_order)||void 0===W?void 0:null===(Y=W.vendor_representative)||void 0===Y?void 0:null===(J=Y.country)||void 0===J?void 0:J.name)})]})})]})]})]})]}),(0,i.jsx)("div",{className:"border rounded p-5 w-full",children:(0,i.jsxs)("div",{className:"table-responsive w-full",children:[(0,i.jsx)("div",{className:"flex justify-between items-center flex-col md:flex-row space-y-3 md:space-y-0 mb-3",children:(0,i.jsx)("h3",{className:"text-lg font-semibold",children:"Item Details"})}),(0,i.jsxs)("table",{children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"Raw Product"}),(0,i.jsx)("th",{children:"Description"}),(0,i.jsx)("th",{children:"Unit"}),(0,i.jsx)("th",{children:"Quantity"}),(0,i.jsx)("th",{children:"Received Quantity"}),(0,i.jsx)("th",{children:"Unit Price"}),(0,i.jsx)("th",{children:"Total"}),(0,i.jsx)("th",{children:"Tax Category"}),(0,i.jsx)("th",{children:"Tax Rate(%)"}),(0,i.jsx)("th",{children:"Tax Amount"}),(0,i.jsx)("th",{children:"Row Total"})]})}),(0,i.jsxs)("tbody",{children:[ed.map((e,l)=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:e.raw_product_title}),(0,i.jsx)("td",{children:e.description}),(0,i.jsx)("td",{children:e.unit_title}),(0,i.jsx)("td",{children:e.quantity}),(0,i.jsx)("td",{children:e.received_quantity}),(0,i.jsx)("td",{children:e.unit_price}),(0,i.jsx)("td",{children:e.total}),(0,i.jsx)("td",{children:e.tax_category_name}),(0,i.jsx)("td",{children:e.tax_rate}),(0,i.jsx)("td",{children:e.tax_amount}),(0,i.jsx)("td",{children:e.row_total})]},l)),0===ed.length?(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:11,className:"text-center",children:"No Item Added"})}):(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{colSpan:3,className:"font-bold text-center",children:"Total"}),(0,i.jsx)("td",{className:"text-left font-bold",children:ed.reduce((e,l)=>e+l.quantity,0)}),(0,i.jsx)("td",{className:"text-left font-bold",children:ed.reduce((e,l)=>e+l.received_quantity,0)}),(0,i.jsx)("td",{className:"text-left font-bold",children:ed.reduce((e,l)=>e+l.unit_price,0)}),(0,i.jsx)("td",{className:"text-left font-bold",children:ed.reduce((e,l)=>e+l.total,0)}),(0,i.jsx)("td",{}),(0,i.jsx)("td",{}),(0,i.jsx)("td",{className:"text-left font-bold",children:ed.reduce((e,l)=>e+l.tax_amount,0)}),(0,i.jsx)("td",{className:"text-left font-bold",children:ed.reduce((e,l)=>e+l.row_total,0)})]})]})]})]})})]}),(0,i.jsxs)("div",{className:"w-full flex justify-center items-center flex-col md:flex-row gap-3",children:[(0,i.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:ee,children:ee?"Loading...":"Save Vendor Bill"}),(0,i.jsx)("button",{type:"button",onClick:()=>{var e;return null==window?void 0:null===(e=window.location)||void 0===e?void 0:e.reload()},className:"btn btn-info",children:"Clear"})]})]})})};l.default=h},52481:function(e,l,d){var i,r;d.d(l,{q:function(){return i}}),(r=i||(i={})).VENDOR="vendor",r.PURCHASE_REQUISITION="purchase-requisition",r.LOCAL_PURCHASE_ORDER="local-purchase-order",r.GOOD_RECEIVE_NOTE="good-receive-note",r.VENDOR_BILL="vendor-bill",r.PRODUCTION="production",r.PRODUCT_ASSEMBLY="product-assembly",r.EMPLOYEE="employee",r.CUSTOMER="customer",r.RAW_MATERIAL="raw-material"}}]);