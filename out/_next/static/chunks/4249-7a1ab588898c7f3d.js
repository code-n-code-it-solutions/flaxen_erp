(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4249],{99930:function(e,t,l){"use strict";var a=l(85893),s=l(67294);let r=e=>{let{image:t,setImage:l}=e,[r,i]=(0,s.useState)(null),n=e=>{let t=e.target.files?e.target.files[0]:null;if(t&&t.type.startsWith("image/")?l(t):l(null),t){let a=new FileReader;a.onloadend=()=>{i(a.result)},a.readAsDataURL(t)}else i(null)};return(0,a.jsxs)("div",{className:"mx-auto p-4 flex flex-col justify-center items-center",children:[r&&(0,a.jsx)("img",{src:r,alt:"Preview",className:"mt-4 w-24 h-24 object-cover border rounded shadow my-3"}),(0,a.jsx)("input",{type:"file",onChange:n,className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-violet-50 file:text-violet-700 hover:file:bg-violet-100"})]})};t.Z=r},54564:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let{children:t}=e;return t},t.suspense=function(){let e=Error(a.NEXT_DYNAMIC_NO_SSR_CODE);throw e.digest=a.NEXT_DYNAMIC_NO_SSR_CODE,e},(0,l(92648).Z)(l(67294));var a=l(92983)},37645:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){let l=i.default,s={loading:e=>{let{error:t,isLoading:l,pastDelay:a}=e;return null}};e instanceof Promise?s.loader=()=>e:"function"==typeof e?s.loader=e:"object"==typeof e&&(s=a({},s,e)),s=a({},s,t);let r=s.loader,n=()=>r().then(d);if(s.loadableGenerated&&delete(s=a({},s,s.loadableGenerated,{loader:n})).loadableGenerated,"boolean"==typeof s.ssr){if(!s.ssr)return delete s.ssr,o(n,s);delete s.ssr}return l(s)},t.noSSR=o;var a=l(6495).Z,s=l(92648).Z,r=(0,l(91598).Z)(l(67294)),i=s(l(14588)),n=s(l(54564));function d(e){return{default:e.default||e}}function o(e,t){delete t.webpack,delete t.modules;let l=r.lazy(e),a=t.loading,s=r.default.createElement(a,{error:null,isLoading:!0,pastDelay:!1,timedOut:!1});return e=>r.default.createElement(r.Suspense,{fallback:s},r.default.createElement(n.default,null,r.default.createElement(l,Object.assign({},e))))}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},33644:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoadableContext=void 0;var a=(0,l(92648).Z)(l(67294));let s=a.default.createContext(null);t.LoadableContext=s},14588:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=l(6495).Z,s=(0,l(92648).Z)(l(67294)),r=l(33644);let i=[],n=[],d=!1;function o(e){let t=e(),l={loading:!0,loaded:null,error:null};return l.promise=t.then(e=>(l.loading=!1,l.loaded=e,e)).catch(e=>{throw l.loading=!1,l.error=e,e}),l}class c{promise(){return this._res.promise}retry(){this._clearTimeouts(),this._res=this._loadFn(this._opts.loader),this._state={pastDelay:!1,timedOut:!1};let{_res:e,_opts:t}=this;e.loading&&("number"==typeof t.delay&&(0===t.delay?this._state.pastDelay=!0:this._delay=setTimeout(()=>{this._update({pastDelay:!0})},t.delay)),"number"==typeof t.timeout&&(this._timeout=setTimeout(()=>{this._update({timedOut:!0})},t.timeout))),this._res.promise.then(()=>{this._update({}),this._clearTimeouts()}).catch(e=>{this._update({}),this._clearTimeouts()}),this._update({})}_update(e){this._state=a({},this._state,{error:this._res.error,loaded:this._res.loaded,loading:this._res.loading},e),this._callbacks.forEach(e=>e())}_clearTimeouts(){clearTimeout(this._delay),clearTimeout(this._timeout)}getCurrentValue(){return this._state}subscribe(e){return this._callbacks.add(e),()=>{this._callbacks.delete(e)}}constructor(e,t){this._loadFn=e,this._opts=t,this._callbacks=new Set,this._delay=null,this._timeout=null,this.retry()}}function u(e){return function(e,t){let l=Object.assign({loader:null,loading:null,delay:200,timeout:null,webpack:null,modules:null},t);l.lazy=s.default.lazy(l.loader);let a=null;function i(){if(!a){let t=new c(e,l);a={getCurrentValue:t.getCurrentValue.bind(t),subscribe:t.subscribe.bind(t),retry:t.retry.bind(t),promise:t.promise.bind(t)}}return a.promise()}if(!d){let o=l.webpack?l.webpack():l.modules;o&&n.push(e=>{for(let t of o)if(-1!==e.indexOf(t))return i()})}function u(e){!function(){i();let e=s.default.useContext(r.LoadableContext);e&&Array.isArray(l.modules)&&l.modules.forEach(t=>{e(t)})}();let t=s.default.createElement(l.loading,{isLoading:!0,pastDelay:!0,error:null});return s.default.createElement(s.default.Suspense,{fallback:t},s.default.createElement(l.lazy,e))}return u.preload=()=>i(),u.displayName="LoadableComponent",u}(o,e)}function m(e,t){let l=[];for(;e.length;){let a=e.pop();l.push(a(t))}return Promise.all(l).then(()=>{if(e.length)return m(e,t)})}u.preloadAll=()=>new Promise((e,t)=>{m(i).then(e,t)}),u.preloadReady=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return new Promise(t=>{let l=()=>(d=!0,t());m(n,e).then(l,l)})},window.__NEXT_PRELOADREADY=u.preloadReady,t.default=u},44249:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return R}});var a=l(85893),s=l(67294),r=l(8303),i=l(9473),n=l(49443);l(8299);var d=l(5152),o=l.n(d),c=l(34532),u=l(49828),m=l(41664),h=l.n(m),p=l(92119),x=l(11355),_=l(31484),f=l(99930);let v=e=>{let{modalOpen:t,setModalOpen:l,handleAddition:r,modalFormData:i,title:n}=e,[d,o]=(0,s.useState)({image:null,number_plate:"",name:"",make:"",model:"",is_active:!0});return(0,s.useEffect)(()=>{t&&o({image:null,number_plate:"",name:"",make:"",model:"",is_active:!0})},[t]),(0,a.jsx)(x.u,{appear:!0,show:t,as:s.Fragment,children:(0,a.jsxs)(_.V,{as:"div",open:t,onClose:()=>l(!1),children:[(0,a.jsx)(x.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,a.jsx)("div",{className:"fixed inset-0"})}),(0,a.jsx)("div",{className:"fixed inset-0 z-[999] overflow-y-auto bg-[black]/60",children:(0,a.jsx)("div",{className:"flex min-h-screen items-start justify-center px-4",children:(0,a.jsx)(x.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,a.jsxs)(_.V.Panel,{as:"div",className:"panel my-8 w-full max-w-lg overflow-hidden rounded-lg border-0 p-0 text-black dark:text-white-dark",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between bg-[#fbfbfb] px-5 py-3 dark:bg-[#121c2c]",children:[(0,a.jsxs)("div",{className:"text-lg font-bold",children:[i?"Edit":"Add"," ",n]}),(0,a.jsx)("button",{type:"button",className:"text-white-dark hover:text-dark",onClick:()=>l(!1),children:(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,a.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),(0,a.jsxs)("div",{className:"p-5 space-y-5",children:[(0,a.jsx)("div",{className:"flex justify-center items-center",children:(0,a.jsx)(f.Z,{image:d.image,setImage:e=>o(t=>({...t,image:e}))})}),(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("label",{htmlFor:"name",children:"Name (Optional)"}),(0,a.jsx)("input",{type:"text",name:"name",id:"name",className:"form-input",placeholder:"Enter Vehicle Name",value:d.name,onChange:e=>o(t=>({...t,name:e.target.value}))})]}),(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("label",{htmlFor:"account_number",children:"Number Plate"}),(0,a.jsx)("input",{type:"text",name:"number_plate",id:"number_plate",className:"form-input",placeholder:"Enter Number Plate",value:d.number_plate,onChange:e=>o(t=>({...t,number_plate:e.target.value}))})]}),(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("label",{htmlFor:"make",children:"Make"}),(0,a.jsx)("input",{type:"text",name:"make",id:"make",className:"form-input",placeholder:"Honda, Toyota, etc",value:d.make,onChange:e=>o(t=>({...t,make:e.target.value}))})]}),(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("label",{htmlFor:"model",children:"Model"}),(0,a.jsx)("input",{type:"text",name:"model",id:"model",className:"form-input",placeholder:"2020, 2021, etc",value:d.model,onChange:e=>o(t=>({...t,model:e.target.value}))})]}),(0,a.jsxs)("div",{className:"mt-8 flex items-center justify-end",children:[(0,a.jsx)("button",{type:"button",className:"btn btn-outline-danger",onClick:()=>l(!1),children:"Discard"}),(0,a.jsx)("button",{type:"button",className:"btn btn-primary ltr:ml-4 rtl:mr-4",onClick:()=>r(d),children:i?"Update":"Add"})]})]})]})})})})]})})};var j=l(32249),b=l(12627),y=l(55331),g=l(8128);let w=e=>{let{modal:t,setModal:l,handleAddRawProduct:d,modalFormData:o}=e,[c,u]=(0,s.useState)("add"),[m,h]=(0,s.useState)(0),[p,f]=(0,s.useState)(0),[v,j]=(0,s.useState)(""),[w,N]=(0,s.useState)(0),[C,S]=(0,s.useState)(0),[k,E]=(0,s.useState)(0),[F,D]=(0,s.useState)(""),[P,O]=(0,s.useState)(0),[R,T]=(0,s.useState)(""),[L,V]=(0,s.useState)(0),[A,I]=(0,s.useState)(""),[q,M]=(0,s.useState)(0),[U,B]=(0,s.useState)(0),[Z,G]=(0,s.useState)(0),W=(0,i.I0)(),[Y,z]=(0,s.useState)([]),[H,Q]=(0,s.useState)([]),[X,$]=(0,s.useState)([]),{token:J}=(0,i.v9)(e=>e.user),{units:K}=(0,i.v9)(e=>e.unit),{allRawProducts:ee}=(0,i.v9)(e=>e.rawProduct),{taxCategories:et}=(0,i.v9)(e=>e.taxCategory);return(0,s.useEffect)(()=>{(0,r.uB)(J),W((0,b.rY)()),W((0,y.eh)()),W((0,g.uh)()),t&&(u(o?"update":"add"),f(o?o.raw_product_id:0),j(o?o.raw_product_title:""),S(o?o.quantity:0),E(o?o.unit_id:0),D(o?o.unit_title:""),N(o?o.unit_price:0),O(o?o.total:0),T(o?o.description:""),V(o?o.tax_category_id:0),I(o?o.tax_category_name:""),M(o?o.tax_rate:0),B(o?o.tax_amount:0),G(o?o.row_total:0))},[t]),(0,s.useEffect)(()=>{K&&z([{value:"",label:"Select Unit"},...K])},[K]),(0,s.useEffect)(()=>{et&&$([{value:"",label:"Select Tax Category"},...et.map(e=>({value:e.id,label:e.name,taxCategory:e}))])},[et]),(0,s.useEffect)(()=>{if(ee){let e=ee.map(e=>({value:e.id,label:e.title+" ("+e.item_code+")",unit_price:e.opening_stock_unit_balance}));console.log("rawProductOptions",e),Q([{value:"",label:"Select Raw Product"},...e])}},[ee]),(0,s.useEffect)(()=>{O(C*w)},[C,w]),(0,a.jsx)(x.u,{appear:!0,show:t,as:s.Fragment,children:(0,a.jsxs)(_.V,{as:"div",open:t,onClose:()=>l(!1),children:[(0,a.jsx)(x.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,a.jsx)("div",{className:"fixed inset-0"})}),(0,a.jsx)("div",{className:"fixed inset-0 z-[999] overflow-y-auto bg-[black]/60",children:(0,a.jsx)("div",{className:"flex min-h-screen items-start justify-center px-4",children:(0,a.jsx)(x.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,a.jsxs)(_.V.Panel,{as:"div",className:"panel my-8 w-full max-w-lg overflow-hidden rounded-lg border-0 p-0 text-black dark:text-white-dark",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between bg-[#fbfbfb] px-5 py-3 dark:bg-[#121c2c]",children:[(0,a.jsxs)("div",{className:"text-lg font-bold",children:[o?"Edit":"Add"," Raw Product"]}),(0,a.jsx)("button",{type:"button",className:"text-white-dark hover:text-dark",onClick:()=>l(!1),children:(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,a.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),(0,a.jsxs)("div",{className:"p-5 space-y-5",children:[(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("label",{htmlFor:"raw_product_id",children:"Raw Product"}),(0,a.jsx)(n.default,{defaultValue:H[0],value:H.map(e=>e.value===p?e:null),options:H,isSearchable:!0,isClearable:!0,placeholder:"Select Product",onChange:e=>{e&&void 0!==e&&(f(e?parseInt(e.value):0),j(e?e.label:""),console.log("e",e),N(e?parseFloat(e.unit_price):0),O(e?e.unit_price*parseInt(C):0))}})]}),(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("label",{htmlFor:"raw_product_id",children:"Select Unit"}),(0,a.jsx)(n.default,{defaultValue:Y[0],value:Y.map(e=>e.value===k?e:null),options:Y,isSearchable:!0,isClearable:!0,placeholder:"Select Unit",onChange:e=>{E(e?parseInt(e.value):0),D(e?e.label:"")}})]}),(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("label",{htmlFor:"raw_product_id",children:"Quantity"}),(0,a.jsx)("input",{type:"number",name:"quantity",className:"form-input",value:C,onChange:e=>S(parseInt(e.target.value))})]}),(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("label",{htmlFor:"unit_price",children:"Unit Cost"}),(0,a.jsx)("input",{type:"number",name:"unit_price",className:"form-input",value:w,onChange:e=>N(parseFloat(e.target.value))})]}),(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("label",{htmlFor:"total",children:"Total"}),(0,a.jsx)("input",{type:"number",name:"total",className:"form-input",value:P,disabled:!0,onChange:e=>O(parseFloat(e.target.value))})]}),(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("label",{htmlFor:"raw_product_id",children:"Select Tax Category"}),(0,a.jsx)(n.default,{defaultValue:X[0],value:X.map(e=>e.value===L?e:null),options:X,isSearchable:!0,isClearable:!0,placeholder:"Select Tax Category",onChange:e=>{e&&void 0!==e&&e.taxCategory?(M(parseFloat(e.taxCategory.rate)),V(e?parseInt(e.value):0),I(e?e.label:""),B(parseFloat(P)*parseFloat(e.taxCategory.rate)/100),G(parseFloat(P)+parseFloat(P)*parseFloat(e.taxCategory.rate)/100)):(M(0),V(0),I(""),B(0),G(parseFloat(P)))}})]}),(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("label",{htmlFor:"tax_rate",children:"Tax Rate (%)"}),(0,a.jsx)("input",{type:"number",name:"tax_rate",className:"form-input",value:q,onChange:e=>{M(parseFloat(e.target.value)),B(parseFloat(P)*parseInt(e.target.value)/100),G(parseFloat(P)+parseFloat(P)*parseInt(e.target.value)/100)}})]}),(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("label",{htmlFor:"tax_amount",children:"Tax Amount"}),(0,a.jsx)("input",{type:"number",name:"tax_amount",className:"form-input",value:U,disabled:!0,onChange:e=>B(parseFloat(e.target.value))})]}),(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("label",{htmlFor:"row_total",children:"Row Total"}),(0,a.jsx)("input",{type:"number",name:"row_total",className:"form-input",value:Z,disabled:!0,onChange:e=>G(parseFloat(e.target.value))})]}),(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("label",{htmlFor:"description",children:"Description"}),(0,a.jsx)("textarea",{name:"description",className:"form-input",value:R,onChange:e=>T(e.target.value)})]}),(0,a.jsxs)("div",{className:"mt-8 flex items-center justify-end",children:[(0,a.jsx)("button",{type:"button",className:"btn btn-outline-danger",onClick:()=>l(!1),children:"Discard"}),(0,a.jsx)("button",{type:"button",className:"btn btn-primary ltr:ml-4 rtl:mr-4",onClick:()=>d({type:o?"update":"add",id:m,raw_product_id:p,raw_product_title:v,unit_id:k,unit_title:F,unit_price:w,quantity:C,total:P,tax_category_id:L,tax_category_name:A,tax_rate:q,tax_amount:U,row_total:Z,description:R}),children:o?"Update":"Add"})]})]})]})})})})]})})};var N=l(25675),C=l.n(N),S=l(33984),k=l(47094),E=l(45286),F=l(76649),D=l(52481);let P=o()(Promise.all([l.e(2937),l.e(939),l.e(1167)]).then(l.t.bind(l,71167,23)),{loadableGenerated:{webpack:()=>[71167]},ssr:!1}),O=e=>{var t,l,d,o,m,x,_,f;let{id:b}=e,y=(0,i.I0)(),{token:g,user:N}=(0,i.v9)(e=>e.user),{code:O}=(0,i.v9)(e=>e.util),{purchaseRequests:R}=(0,i.v9)(e=>e.purchaseRequisition),{loading:T}=(0,i.v9)(e=>e.localPurchaseOrder),{allVendors:L,representatives:V}=(0,i.v9)(e=>e.vendor),{currencies:A}=(0,i.v9)(e=>e.currency),{vehicle:I,success:q,vehicles:M}=(0,i.v9)(e=>e.vehicle),{employees:U}=(0,i.v9)(e=>e.employee),[B,Z]=(0,s.useState)(!1),[G,W]=(0,s.useState)({}),[Y,z]=(0,s.useState)(!1),[H,Q]=(0,s.useState)([]),[X,$]=(0,s.useState)({purchase_requisition_id:0,lpo_number:"",vendor_id:0,description:"",user_id:N.id,department_id:null===(t=N.employee)||void 0===t?void 0:t.department_id,designation_id:null===(l=N.employee)||void 0===l?void 0:l.designation_id,internal_document_number:"",vendor_representative_id:"",vehicle_id:0,purchased_by_id:0,received_by_id:0,delivery_due_in_days:0,delivery_due_date:"",term_and_conditions:"",payment_terms_in_days:0,currency_id:0,status:"",terms_conditions:"",items:[]}),[J,K]=(0,s.useState)([]),[ee,et]=(0,s.useState)([]),[el,ea]=(0,s.useState)([]),[es,er]=(0,s.useState)([]),[ei,en]=(0,s.useState)([]),[ed,eo]=(0,s.useState)([]),[ec,eu]=(0,s.useState)([]),[em,eh]=(0,s.useState)(!1),[ep,ex]=(0,s.useState)({}),[e_,ef]=(0,s.useState)(!1),[ev,ej]=(0,s.useState)({}),[eb,ey]=(0,s.useState)(!1),[eg,ew]=(0,s.useState)({}),[eN,eC]=(0,s.useState)([{value:"",label:"Select Status"},{value:"Draft",label:"Draft"},{value:"Pending",label:"Proceed"}]),eS=e=>{let{name:t,value:l}=e.target;if($(e=>({...e,[t]:l})),"delivery_due_in_days"===t){if(""===l){$(e=>({...e,delivery_due_date:""}));return}{let a=new Date;a.setDate(a.getDate()+parseInt(l)),$(e=>({...e,delivery_due_date:a.toDateString()}))}}},ek=e=>{Q(t=>{let l=0;t.forEach(e=>{e.id>l&&(l=e.id)});let a=t.find(t=>t.raw_product_title===e.raw_product_title);if(a)return console.log("existing row",a),t.map(t=>t.raw_product_title===e.raw_product_title?e:t);{let s={...e,id:l+1};return console.log("new row",s),[...t,s]}}),ew({}),z(!1)},eE=e=>{let t=H.filter((t,l)=>l===e);t.length>0?(ew(t[0]),z(!0)):(z(!1),ew({}))},eF=e=>{let t=H.filter((t,l)=>l!==e);Q(t)},eD=e=>{var t,l;e.preventDefault(),(0,r.uB)(g),(0,r.OG)("multipart/form-data");let a={...X,user_id:N.id,department_id:null===(t=N.employee)||void 0===t?void 0:t.department_id,designation_id:null===(l=N.employee)||void 0===l?void 0:l.designation_id,items:H.map(e=>({raw_product_id:e.raw_product_id,quantity:e.quantity,unit_id:e.unit_id,unit_price:e.unit_price,total:e.total,description:e.description||"",tax_category_id:e.tax_category_id,tax_rate:e.tax_rate,tax_amount:e.tax_amount,row_total:e.row_total}))};b||y((0,E.y8)(a))},eP=e=>{e&&void 0!==e?($(t=>({...t,vendor_id:e.value})),Z(!0),W(e.vendor),y((0,u.YU)(e.value)),console.log(e.vendor)):(Z(!1),W({}))},eO=e=>{e&&void 0!==e?($(t=>({...t,vendor_representative_id:e.value})),ex(e.representative),ef(!0),console.log(e.vendor)):(ex({}),ef(!1),y((0,u.Ro)()))},eR=e=>{e&&void 0!==e?($(t=>({...t,vehicle_id:e.value})),ej(e.vehicle),ey(!0)):(ej({}),ey(!1))},eT=e=>{if(e&&void 0!==e){var t;$(t=>({...t,purchase_requisition_id:e.value})),(null===(t=e.request.purchase_requisition_items)||void 0===t?void 0:t.length)>0&&(console.log(e.request.purchase_requisition_items),Q(t=>e.request.purchase_requisition_items.map(e=>({raw_product_id:e.raw_product_id,raw_product_title:e.raw_product.title+" ("+e.raw_product.item_code+")",quantity:parseInt(e.quantity),unit_id:e.unit_id,unit_title:e.unit.short_name,unit_price:parseFloat(e.unit_price),total:parseFloat(e.unit_price)*parseInt(e.quantity),description:e.description||"",tax_category_name:"",tax_category_id:0,tax_rate:0,tax_amount:0,row_total:e.unit_price*e.quantity}))))}else $(e=>({...e,purchase_requisition_id:0})),Q([])},eL=e=>{(0,r.OG)("multipart/form-data"),(0,r.uB)(g),y((0,j.cH)(e))};return(0,s.useEffect)(()=>{y((0,c.aP)()),(0,r.uB)(g),(0,r.OG)("application/json"),y((0,u.Ro)()),y((0,u.dH)()),y((0,p.DE)()),y((0,j.$L)()),y((0,j.rE)()),y((0,c.OR)({statuses:["Pending"]})),y((0,k.fN)()),y((0,F.ge)()),y((0,F.bB)(D.q.LOCAL_PURCHASE_ORDER))},[]),(0,s.useEffect)(()=>{O&&$(e=>({...e,lpo_number:O}))},[O]),(0,s.useEffect)(()=>{L&&et(L.map(e=>({value:e.id,label:e.name,vendor:e})))},[L]),(0,s.useEffect)(()=>{R&&K(R.map(e=>({value:e.id,label:e.pr_title+" ("+e.pr_code+")",request:e})))},[R]),(0,s.useEffect)(()=>{V&&er(V.map(e=>({value:e.id,label:e.name,representative:e})))},[V]),(0,s.useEffect)(()=>{A&&ea(A.map(e=>({value:e.id,label:e.code,currency:e})))},[A]),(0,s.useEffect)(()=>{I&&(y((0,j.rE)()),eh(!1),y((0,j.$L)()))},[I]),(0,s.useEffect)(()=>{M&&en(M.map(e=>({value:e.id,label:e.make+"-"+e.model+" ("+e.number_plate+")",vehicle:e})))},[M]),(0,s.useEffect)(()=>{U&&(eo(U.map(e=>({value:e.user.id,label:e.user.name+" ("+e.employee_code+")",employee:e}))),eu(U.map(e=>({value:e.user.id,label:e.user.name+" ("+e.employee_code+")",employee:e}))),console.log(ed,ec))},[U]),(0,s.useEffect)(()=>{Y||ew({})},[Y]),(0,a.jsxs)("form",{className:"space-y-5",onSubmit:e=>eD(e),children:[(0,a.jsxs)("div",{className:"flex justify-start flex-col items-start space-y-3",children:[(0,a.jsxs)("div",{className:"w-full md:w-1/2",children:[(0,a.jsx)("label",{htmlFor:"purchase_requisition_id",children:"Purchase Requisition"}),(0,a.jsx)(n.default,{defaultValue:J[0],options:J,isSearchable:!0,isClearable:!0,placeholder:"Select Request",onChange:e=>eT(e)})]}),(0,a.jsxs)("div",{className:"border rounded p-5 w-full",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Basic Details"}),(0,a.jsx)("hr",{className:"my-3"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 w-full my-5",children:[(0,a.jsxs)("div",{className:"w-full space-y-3",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 w-full",children:[(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("label",{htmlFor:"lpo_number",children:"LPO Number"}),(0,a.jsx)("input",{id:"lpo_number",type:"text",name:"lpo_number",placeholder:"Enter LPO number",value:X.lpo_number,onChange:eS,disabled:!0,className:"form-input"})]}),(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("label",{htmlFor:"internal_document_number",children:"Internal Document Number"}),(0,a.jsx)("input",{id:"internal_document_number",type:"text",name:"internal_document_number",placeholder:"Enter Internal Document Number",value:X.internal_document_number,onChange:eS,className:"form-input"})]})]}),(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("label",{htmlFor:"status_id",children:"Status"}),(0,a.jsx)(n.default,{defaultValue:eN[0],options:eN,isSearchable:!0,isClearable:!0,placeholder:"Select Status",onChange:e=>$(t=>({...t,status:e&&void 0!==e?e.value:""}))})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 w-full",children:[(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("label",{htmlFor:"received_by_id",children:"Received By"}),(0,a.jsx)(n.default,{defaultValue:ed[0],options:ed,isSearchable:!0,isClearable:!0,placeholder:"Select Employee",onChange:e=>$(t=>({...t,received_by_id:e&&void 0!==e?e.value:0}))})]}),(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("label",{htmlFor:"purchased_by_id",children:"Purchased By"}),(0,a.jsx)(n.default,{defaultValue:ec[0],options:ec,isSearchable:!0,isClearable:!0,placeholder:"Select Employee",onChange:e=>$(t=>({...t,purchased_by_id:e&&void 0!==e?e.value:0}))})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 w-full",children:[(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("label",{htmlFor:"delivery_due_in_days",children:"Delivery Due Days"}),(0,a.jsx)("input",{id:"delivery_due_in_days",type:"text",name:"delivery_due_in_days",placeholder:"Delivery Due Days",value:X.delivery_due_in_days,onChange:eS,className:"form-input"})]}),(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("label",{htmlFor:"delivery_due_date",children:"Delivery Due Date"}),(0,a.jsx)("input",{id:"delivery_due_date",type:"text",name:"delivery_due_date",placeholder:"Delivery Due Date",disabled:!0,value:X.delivery_due_date,onChange:eS,className:"form-input"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 w-full",children:[(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("label",{htmlFor:"payment_terms_in_days",children:"Payment Terms (Days)"}),(0,a.jsx)("input",{id:"payment_terms_in_days",type:"text",name:"payment_terms_in_days",placeholder:"Payment Terms (Days)",value:X.payment_terms_in_days,onChange:eS,className:"form-input"})]}),(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("label",{htmlFor:"currency_id",children:"Currency"}),(0,a.jsx)(n.default,{defaultValue:el[0],options:el,isSearchable:!0,isClearable:!0,placeholder:"Select Currency",onChange:e=>$(t=>({...t,currency_id:e&&void 0!==e?e.value:0}))})]})]})]}),(0,a.jsxs)("div",{className:"w-full space-y-3",children:[(0,a.jsxs)("div",{className:"w-full flex justify-between items-end gap-3",children:[(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("label",{htmlFor:"vehicle_id",children:"Shipped Via (Vehicle)"}),(0,a.jsx)(n.default,{defaultValue:ei[0],options:ei,isSearchable:!0,isClearable:!0,placeholder:"Select Vehicle",onChange:e=>eR(e)})]}),(0,a.jsx)("button",{className:"btn btn-primary btn-sm flex justify-center items-center",onClick:()=>eh(!0),children:(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",className:"h-5 w-5 ltr:mr-2 rtl:ml-2",fill:"none",children:[(0,a.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"1.5"}),(0,a.jsx)("path",{d:"M15 12L12 12M12 12L9 12M12 12L12 9M12 12L12 15",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]})})]}),(0,a.jsxs)("div",{className:"w-full",hidden:!eb,children:[(0,a.jsx)("h4",{className:"font-bold text-lg",children:"Vehicle Details"}),(0,a.jsxs)("div",{className:"flex flex-col gap-3 justify-center items-center",children:[(0,a.jsx)(C(),{src:S._+"/"+(null===(d=ev.thumbnail)||void 0===d?void 0:d.path),alt:"Vehicle Image",height:100,width:100}),(0,a.jsxs)("table",{children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Number Plate"}),(0,a.jsx)("th",{children:"Make"}),(0,a.jsx)("th",{children:"Modal"})]})}),(0,a.jsx)("tbody",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:ev.number_plate}),(0,a.jsx)("td",{children:ev.make}),(0,a.jsx)("td",{children:ev.model})]})})]})]})]}),(0,a.jsx)("div",{hidden:eb,children:"No Vehicle Selected"})]})]})]}),(0,a.jsxs)("div",{className:"border rounded p-5 w-full",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Vendor Details"}),(0,a.jsx)(h(),{href:"/admin/vendors/create",className:"btn btn-primary btn-sm m-1",children:(0,a.jsxs)("span",{className:"flex items-center",children:[(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",className:"h-5 w-5 ltr:mr-2 rtl:ml-2",fill:"none",children:[(0,a.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"1.5"}),(0,a.jsx)("path",{d:"M15 12L12 12M12 12L9 12M12 12L12 9M12 12L12 15",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]}),"Create Vendor"]})})]}),(0,a.jsx)("hr",{className:"my-3"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 w-full my-5 ",children:[(0,a.jsxs)("div",{className:"w-full space-y-3",children:[(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("label",{htmlFor:"vendor_id",children:"Vendor"}),(0,a.jsx)(n.default,{defaultValue:ee[0],options:ee,isSearchable:!0,isClearable:!0,placeholder:"Select Vendor",onChange:e=>eP(e)})]}),(0,a.jsxs)("div",{className:"w-full",hidden:!B,children:[(0,a.jsx)("h4",{className:"font-bold text-lg",children:"Vendor Details"}),(0,a.jsxs)("table",{children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Vendor Number"}),(0,a.jsx)("th",{children:"Vendor Name"}),(0,a.jsx)("th",{children:"Billed From"}),(0,a.jsx)("th",{children:"Shift From"})]})}),(0,a.jsx)("tbody",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:G.vendor_number}),(0,a.jsx)("td",{children:G.name}),(0,a.jsx)("td",{children:null===(o=G.addresses)||void 0===o?void 0:o.map((e,t)=>{if("billing"===e.type){var l,a,s;return e.address+", "+(null===(l=e.city)||void 0===l?void 0:l.name)+", "+(null===(a=e.state)||void 0===a?void 0:a.name)+", "+(null===(s=e.country)||void 0===s?void 0:s.name)}})}),(0,a.jsx)("td",{children:null===(m=G.addresses)||void 0===m?void 0:m.map((e,t)=>{if("shifting"===e.type){var l,a,s;return e.address+", "+(null===(l=e.city)||void 0===l?void 0:l.name)+", "+(null===(a=e.state)||void 0===a?void 0:a.name)+", "+(null===(s=e.country)||void 0===s?void 0:s.name)}})})]})})]})]})]}),(0,a.jsxs)("div",{className:"w-full space-y-3",children:[(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("label",{htmlFor:"vendor_representatative_id",children:"Vendor Representative"}),(0,a.jsx)(n.default,{defaultValue:es[0],options:es,isSearchable:!0,isClearable:!0,placeholder:"Select Representative",onChange:e=>eO(e)})]}),(0,a.jsxs)("div",{className:"w-full",hidden:!e_,children:[(0,a.jsx)("h4",{className:"font-bold text-lg",children:"Representative Details"}),(0,a.jsxs)("table",{children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Name"}),(0,a.jsx)("th",{children:"Phone"}),(0,a.jsx)("th",{children:"Email"}),(0,a.jsx)("th",{children:"Address"})]})}),(0,a.jsx)("tbody",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:ep.name}),(0,a.jsx)("td",{children:ep.phone}),(0,a.jsx)("td",{children:ep.email}),(0,a.jsx)("td",{children:ep.address+", "+(null===(x=ep.city)||void 0===x?void 0:x.name)+", "+(null===(_=ep.state)||void 0===_?void 0:_.name)+", "+(null===(f=ep.country)||void 0===f?void 0:f.name)})]})})]})]})]})]})]}),(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("h4",{className:"font-bold text-lg",children:"Terms & Conditions"}),(0,a.jsx)(P,{theme:"snow",value:X.terms_conditions,onChange:e=>$(t=>({...t,terms_conditions:e}))})]}),(0,a.jsxs)("div",{className:"table-responsive w-full",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center flex-col md:flex-row space-y-3 md:space-y-0 mb-3",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Item Details"}),(0,a.jsx)("button",{type:"button",className:"btn btn-primary btn-sm",onClick:()=>{ew({}),z(!0)},children:"Add New Item"})]}),(0,a.jsxs)("table",{children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Raw Product"}),(0,a.jsx)("th",{children:"Description"}),(0,a.jsx)("th",{children:"Unit"}),(0,a.jsx)("th",{children:"Quantity"}),(0,a.jsx)("th",{children:"Unit Price"}),(0,a.jsx)("th",{children:"Total"}),(0,a.jsx)("th",{children:"Tax Category"}),(0,a.jsx)("th",{children:"Tax Rate(%)"}),(0,a.jsx)("th",{children:"Tax Amount"}),(0,a.jsx)("th",{children:"Row Total"}),(0,a.jsx)("th",{children:"Action"})]})}),(0,a.jsxs)("tbody",{children:[H.map((e,t)=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:e.raw_product_title}),(0,a.jsx)("td",{children:e.description}),(0,a.jsx)("td",{children:e.unit_title}),(0,a.jsx)("td",{children:e.quantity}),(0,a.jsx)("td",{children:e.unit_price}),(0,a.jsx)("td",{children:e.total}),(0,a.jsx)("td",{children:e.tax_category_name}),(0,a.jsx)("td",{children:e.tax_rate}),(0,a.jsx)("td",{children:e.tax_amount}),(0,a.jsx)("td",{children:e.row_total}),(0,a.jsx)("td",{children:(0,a.jsxs)("div",{className:"flex gap-3 items-center",children:[(0,a.jsx)("button",{type:"button",className:"btn btn-outline-primary btn-sm",onClick:()=>eE(t),children:"Edit"}),(0,a.jsx)("button",{type:"button",onClick:()=>eF(t),className:"btn btn-outline-danger btn-sm",children:"Delete"})]})})]},t)),0===H.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:11,className:"text-center",children:"No Item Added"})}):(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{colSpan:3,className:"font-bold text-center",children:"Total"}),(0,a.jsx)("td",{className:"text-left font-bold",children:H.reduce((e,t)=>e+t.quantity,0)}),(0,a.jsx)("td",{className:"text-left font-bold",children:H.reduce((e,t)=>e+t.unit_price,0)}),(0,a.jsx)("td",{className:"text-left font-bold",children:H.reduce((e,t)=>e+t.total,0)}),(0,a.jsx)("td",{}),(0,a.jsx)("td",{}),(0,a.jsx)("td",{className:"text-left font-bold",children:H.reduce((e,t)=>e+t.tax_amount,0)}),(0,a.jsx)("td",{className:"text-left font-bold",children:H.reduce((e,t)=>e+t.row_total,0)})]})]})]})]}),(0,a.jsxs)("div",{className:"w-full flex justify-center items-center flex-col md:flex-row gap-3",children:[(0,a.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:T,children:T?"Loading...":"Save LPO"}),(0,a.jsx)("button",{type:"button",onClick:()=>{var e;return null==window?void 0:null===(e=window.location)||void 0===e?void 0:e.reload()},className:"btn btn-info",children:"Clear"})]})]}),(0,a.jsx)(v,{modalOpen:em,setModalOpen:eh,handleAddition:e=>eL(e),title:"Vehicle"}),(0,a.jsx)(w,{modal:Y,setModal:z,modalFormData:eg,handleAddRawProduct:e=>ek(e)})]})};var R=O},52481:function(e,t,l){"use strict";var a,s;l.d(t,{q:function(){return a}}),(s=a||(a={})).VENDOR="vendor",s.PURCHASE_REQUISITION="purchase-requisition",s.LOCAL_PURCHASE_ORDER="local-purchase-order",s.GOOD_RECEIVE_NOTE="good-receive-note",s.VENDOR_BILL="vendor-bill",s.PRODUCTION="production",s.PRODUCT_ASSEMBLY="product-assembly",s.EMPLOYEE="employee",s.CUSTOMER="customer",s.RAW_MATERIAL="raw-material"},8299:function(){},5152:function(e,t,l){e.exports=l(37645)}}]);