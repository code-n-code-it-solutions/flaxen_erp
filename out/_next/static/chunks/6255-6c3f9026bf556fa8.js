"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6255],{16255:function(e,t,i){i.r(t);var l=i(85893),d=i(67294),r=i(8303),s=i(9473),n=i(49443),a=i(45286),o=i(46236),c=i(76649),u=i(52481);let h=e=>{var t,i,h,v,x,m,_,j,p,b,f,y,N,g,w,S,E,q,R,O,C,P;let{id:D}=e,I=(0,s.I0)(),{token:T,user:L}=(0,s.v9)(e=>e.user),{success:A,loading:V}=(0,s.v9)(e=>e.goodReceiveNote),{allLPOs:B}=(0,s.v9)(e=>e.localPurchaseOrder),{code:U}=(0,s.v9)(e=>e.util),[F,k]=(0,d.useState)(!1),[G,M]=(0,d.useState)([]),[Q,H]=(0,d.useState)({purchase_requisition_id:0,local_purchase_order_id:0,grn_number:"",received_by_id:0,verified_by_id:0,status:"",description:"",items:[]}),[Y,W]=(0,d.useState)([]),[Z,z]=(0,d.useState)({}),[J,K]=(0,d.useState)(!0),[X,$]=(0,d.useState)({}),[ee,et]=(0,d.useState)([{value:"",label:"Select Status"},{value:"Draft",label:"Draft"},{value:"Pending",label:"Proceed"}]),ei=e=>{e.preventDefault(),(0,r.uB)(T),console.log(L);let t={...Q,user_id:L.id,items:G.map(e=>({raw_product_id:e.raw_product_id,quantity:e.quantity,received_quantity:e.received_quantity,unit_id:e.unit_id,unit_price:e.unit_price,total:e.total,description:e.description||"",tax_category_id:e.tax_category_id,tax_rate:e.tax_rate,tax_amount:e.tax_amount,row_total:e.row_total}))};D||I((0,o.Bq)(t))},el=e=>{if(e&&void 0!==e){var t;console.log(e),H(t=>({...t,local_purchase_order_id:e.value,purchase_requisition_id:e.lpo.purchase_requisition_id,received_by_id:e.lpo.received_by_id,verified_by_id:e.lpo.received_by_id})),z(e.lpo),K(!1),(null===(t=e.lpo.items)||void 0===t?void 0:t.length)>0&&M(t=>e.lpo.items.map(e=>{var t;return{raw_product_id:e.raw_product_id,raw_product_title:e.raw_product.title+" ("+e.raw_product.item_code+")",quantity:parseInt(e.quantity),received_quantity:0,unit_id:e.unit_id,unit_title:e.unit.short_name,unit_price:parseFloat(e.unit_price),total:parseFloat(e.unit_price)*parseInt(e.quantity),description:e.description||"",tax_category_name:null===(t=e.tax_category)||void 0===t?void 0:t.name,tax_category_id:e.tax_category_id,tax_rate:e.tax_rate,tax_amount:e.tax_amount,row_total:e.unit_price*e.quantity}}))}else H(e=>({...e,local_purchase_order_id:0,purchase_requisition_id:0})),z({}),M([]),K(!0)};return(0,d.useEffect)(()=>{I((0,o.eO)()),(0,r.uB)(T),(0,r.OG)("application/json"),I((0,a.jZ)({statuses:["Pending"]})),I((0,c.ge)()),I((0,c.bB)(u.q.GOOD_RECEIVE_NOTE))},[]),(0,d.useEffect)(()=>{U&&H(e=>({...e,grn_number:U}))},[U]),(0,d.useEffect)(()=>{F||$({})},[F]),(0,d.useEffect)(()=>{B&&W(B.map(e=>({value:e.id,label:e.lpo_number,lpo:e})))},[B]),(0,l.jsx)("form",{className:"space-y-5",onSubmit:e=>ei(e),children:(0,l.jsxs)("div",{className:"flex justify-start flex-col items-start space-y-3",children:[(0,l.jsxs)("div",{className:"w-full md:w-1/2",children:[(0,l.jsx)("label",{htmlFor:"purchase_requisition_id",children:"LPO"}),(0,l.jsx)(n.default,{defaultValue:Y[0],options:Y,isSearchable:!0,isClearable:!0,placeholder:"Select LPO",onChange:e=>el(e)})]}),(0,l.jsxs)("div",{className:"w-full md:w-1/2",children:[(0,l.jsx)("label",{htmlFor:"status",children:"Status"}),(0,l.jsx)(n.default,{defaultValue:ee[0],options:ee,isSearchable:!0,isClearable:!0,placeholder:"Select Status",onChange:e=>H(t=>({...t,status:e&&void 0!==e?e.value:""}))})]}),(0,l.jsxs)("div",{className:"w-full md:w-1/2",children:[(0,l.jsx)("label",{htmlFor:"grn_number",children:"Good Receive Note Number"}),(0,l.jsx)("input",{type:"text",className:"form-input",placeholder:"Good Receive Note Number",disabled:!0,value:Q.grn_number,onChange:e=>H(t=>({...t,grn_number:e.target.value}))})]}),(0,l.jsxs)("div",{hidden:J,className:"w-full space-y-3",children:[(0,l.jsxs)("div",{className:"border rounded p-5 w-full",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold",children:"LPO Details"}),(0,l.jsx)("hr",{className:"my-3"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 w-full my-5",children:[(0,l.jsxs)("div",{className:"w-full",children:[(0,l.jsx)("strong",{children:"Requisition Number: "}),(0,l.jsx)("span",{children:null===(t=Z.purchase_requisition)||void 0===t?void 0:t.pr_code})]}),(0,l.jsxs)("div",{className:"w-full",children:[(0,l.jsx)("strong",{children:"LPO Number: "}),(0,l.jsx)("span",{children:Z.lpo_number})]}),(0,l.jsxs)("div",{className:"w-full",children:[(0,l.jsx)("strong",{children:"Internal Document Number: "}),(0,l.jsx)("span",{children:Z.internal_document_number})]}),(0,l.jsxs)("div",{className:"w-full",children:[(0,l.jsx)("strong",{children:"Purchase By: "}),(0,l.jsx)("span",{children:null===(i=Z.purchased_by)||void 0===i?void 0:i.name})]}),(0,l.jsxs)("div",{className:"w-full",children:[(0,l.jsx)("strong",{children:"Received By: "}),(0,l.jsx)("span",{children:null===(h=Z.received_by)||void 0===h?void 0:h.name})]}),(0,l.jsxs)("div",{className:"w-full",children:[(0,l.jsx)("strong",{children:"Shipped Via: "}),(0,l.jsx)("span",{children:(null===(v=Z.vehicle)||void 0===v?void 0:v.name)+"-"+(null===(x=Z.vehicle)||void 0===x?void 0:x.make)+" ("+(null===(m=Z.vehicle)||void 0===m?void 0:m.number_plate)+")"})]})]}),(0,l.jsx)("hr",{className:"my-3"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,l.jsxs)("div",{className:"table-responsive",children:[(0,l.jsx)("h4",{className:"font-bold text-lg",children:"Vendor Details"}),(0,l.jsxs)("table",{children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:"Vendor Number"}),(0,l.jsx)("th",{children:"Vendor Name"}),(0,l.jsx)("th",{children:"Billed From"}),(0,l.jsx)("th",{children:"Shift From"})]})}),(0,l.jsx)("tbody",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:null===(_=Z.vendor)||void 0===_?void 0:_.vendor_number}),(0,l.jsx)("td",{children:null===(j=Z.vendor)||void 0===j?void 0:j.name}),(0,l.jsx)("td",{children:null===(p=Z.vendor)||void 0===p?void 0:null===(b=p.addresses)||void 0===b?void 0:b.map((e,t)=>{if("billing"===e.type){var i,l,d;return e.address+", "+(null===(i=e.city)||void 0===i?void 0:i.name)+", "+(null===(l=e.state)||void 0===l?void 0:l.name)+", "+(null===(d=e.country)||void 0===d?void 0:d.name)}})}),(0,l.jsx)("td",{children:null===(f=Z.vendor)||void 0===f?void 0:null===(y=f.addresses)||void 0===y?void 0:y.map((e,t)=>{if("shifting"===e.type){var i,l,d;return e.address+", "+(null===(i=e.city)||void 0===i?void 0:i.name)+", "+(null===(l=e.state)||void 0===l?void 0:l.name)+", "+(null===(d=e.country)||void 0===d?void 0:d.name)}})})]})})]})]}),(0,l.jsxs)("div",{className:"table-responsive",children:[(0,l.jsx)("h4",{className:"font-bold text-lg",children:"Representative Details"}),(0,l.jsxs)("table",{children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:"Name"}),(0,l.jsx)("th",{children:"Phone"}),(0,l.jsx)("th",{children:"Email"}),(0,l.jsx)("th",{children:"Address"})]})}),(0,l.jsx)("tbody",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:null===(N=Z.vendor_representative)||void 0===N?void 0:N.name}),(0,l.jsx)("td",{children:null===(g=Z.vendor_representative)||void 0===g?void 0:g.phone}),(0,l.jsx)("td",{children:null===(w=Z.vendor_representative)||void 0===w?void 0:w.email}),(0,l.jsx)("td",{children:(null===(S=Z.vendor_representative)||void 0===S?void 0:S.address)+", "+(null===(E=Z.vendor_representative)||void 0===E?void 0:null===(q=E.city)||void 0===q?void 0:q.name)+", "+(null===(R=Z.vendor_representative)||void 0===R?void 0:null===(O=R.state)||void 0===O?void 0:O.name)+", "+(null===(C=Z.vendor_representative)||void 0===C?void 0:null===(P=C.country)||void 0===P?void 0:P.name)})]})})]})]})]})]}),(0,l.jsx)("div",{className:"border rounded p-5 w-full",children:(0,l.jsxs)("div",{className:"table-responsive w-full",children:[(0,l.jsx)("div",{className:"flex justify-between items-center flex-col md:flex-row space-y-3 md:space-y-0 mb-3",children:(0,l.jsx)("h3",{className:"text-lg font-semibold",children:"Item Details"})}),(0,l.jsxs)("table",{children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:"Raw Product"}),(0,l.jsx)("th",{children:"Description"}),(0,l.jsx)("th",{children:"Unit"}),(0,l.jsx)("th",{children:"Quantity"}),(0,l.jsx)("th",{children:"Received Quantity"}),(0,l.jsx)("th",{children:"Unit Price"}),(0,l.jsx)("th",{children:"Total"}),(0,l.jsx)("th",{children:"Tax Category"}),(0,l.jsx)("th",{children:"Tax Rate(%)"}),(0,l.jsx)("th",{children:"Tax Amount"}),(0,l.jsx)("th",{children:"Row Total"})]})}),(0,l.jsxs)("tbody",{children:[G.map((e,t)=>(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:e.raw_product_title}),(0,l.jsx)("td",{children:e.description}),(0,l.jsx)("td",{children:e.unit_title}),(0,l.jsx)("td",{children:e.quantity}),(0,l.jsx)("td",{children:(0,l.jsx)("input",{type:"number",className:"form-input",name:"received_quantity",value:e.received_quantity,onChange:e=>{let{value:i}=e.target;M(e=>e.map((e,l)=>l===t?{...e,received_quantity:parseInt(i)}:e))}})}),(0,l.jsx)("td",{children:e.unit_price}),(0,l.jsx)("td",{children:e.total}),(0,l.jsx)("td",{children:e.tax_category_name}),(0,l.jsx)("td",{children:e.tax_rate}),(0,l.jsx)("td",{children:e.tax_amount}),(0,l.jsx)("td",{children:e.row_total})]},t)),0===G.length?(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:11,className:"text-center",children:"No Item Added"})}):(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{colSpan:3,className:"font-bold text-center",children:"Total"}),(0,l.jsx)("td",{className:"text-left font-bold",children:G.reduce((e,t)=>e+t.quantity,0)}),(0,l.jsx)("td",{className:"text-left font-bold",children:G.reduce((e,t)=>e+t.received_quantity,0)}),(0,l.jsx)("td",{className:"text-left font-bold",children:G.reduce((e,t)=>e+t.unit_price,0)}),(0,l.jsx)("td",{className:"text-left font-bold",children:G.reduce((e,t)=>e+t.total,0)}),(0,l.jsx)("td",{}),(0,l.jsx)("td",{}),(0,l.jsx)("td",{className:"text-left font-bold",children:G.reduce((e,t)=>e+t.tax_amount,0)}),(0,l.jsx)("td",{className:"text-left font-bold",children:G.reduce((e,t)=>e+t.row_total,0)})]})]})]})]})})]}),(0,l.jsxs)("div",{className:"w-full flex justify-center items-center flex-col md:flex-row gap-3",children:[(0,l.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:V,children:V?"Loading...":"Save Good Receive Note"}),(0,l.jsx)("button",{type:"button",onClick:()=>{var e;return null==window?void 0:null===(e=window.location)||void 0===e?void 0:e.reload()},className:"btn btn-info",children:"Clear"})]})]})})};t.default=h},52481:function(e,t,i){var l,d;i.d(t,{q:function(){return l}}),(d=l||(l={})).VENDOR="vendor",d.PURCHASE_REQUISITION="purchase-requisition",d.LOCAL_PURCHASE_ORDER="local-purchase-order",d.GOOD_RECEIVE_NOTE="good-receive-note",d.VENDOR_BILL="vendor-bill",d.PRODUCTION="production",d.PRODUCT_ASSEMBLY="product-assembly",d.EMPLOYEE="employee",d.CUSTOMER="customer",d.RAW_MATERIAL="raw-material"}}]);