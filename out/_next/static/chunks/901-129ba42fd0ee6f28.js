"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[901],{80901:function(e,t,a){a.r(t),a.d(t,{default:function(){return f}});var l=a(85893),i=a(67294),s=a(8303),r=a(9473),n=a(49443),d=a(34532),c=a(11355),u=a(31484),o=a(12627),h=a(55331),p=a(472);let m=e=>{let{modal:t,setModal:a,handleAddRawProduct:d,modalFormData:m}=e,[x,j]=(0,i.useState)(0),[v,f]=(0,i.useState)(0),[_,b]=(0,i.useState)(""),[y,w]=(0,i.useState)(0),[N,g]=(0,i.useState)(0),[S,C]=(0,i.useState)(0),[E,R]=(0,i.useState)(""),[P,q]=(0,i.useState)(0),[F,k]=(0,i.useState)(""),D=(0,r.I0)(),[I,O]=(0,i.useState)([]),[U,T]=(0,i.useState)([]),{token:A}=(0,r.v9)(e=>e.user),{units:L}=(0,r.v9)(e=>e.unit),{allRawProducts:M}=(0,r.v9)(e=>e.rawProduct);return(0,i.useEffect)(()=>{(0,s.uB)(A),D((0,o.rY)()),D((0,h.eh)()),t&&(j(m?m.id:performance.now()+(0,p.X)(1e3,9999)),f(m?m.raw_product_id:0),b(m?m.raw_product_title:""),g(m?m.quantity:0),C(m?m.unit_id:0),R(m?m.unit_title:""),w(m?m.unit_price:0),q(m?m.total:0),k(m?m.description:""))},[t]),(0,i.useEffect)(()=>{L&&O([{value:"",label:"Select Unit"},...L])},[L]),(0,i.useEffect)(()=>{M&&T([{value:"",label:"Select Raw Product"},...M.map(e=>({value:e.id,label:e.title,unit_price:e.opening_stock_unit_balance}))])},[M]),(0,i.useEffect)(()=>{q(N*y)},[N,y]),(0,l.jsx)(c.u,{appear:!0,show:t,as:i.Fragment,children:(0,l.jsxs)(u.V,{as:"div",open:t,onClose:()=>a(!1),children:[(0,l.jsx)(c.u.Child,{as:i.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,l.jsx)("div",{className:"fixed inset-0"})}),(0,l.jsx)("div",{className:"fixed inset-0 z-[999] overflow-y-auto bg-[black]/60",children:(0,l.jsx)("div",{className:"flex min-h-screen items-start justify-center px-4",children:(0,l.jsx)(c.u.Child,{as:i.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,l.jsxs)(u.V.Panel,{as:"div",className:"panel my-8 w-full max-w-lg overflow-hidden rounded-lg border-0 p-0 text-black dark:text-white-dark",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between bg-[#fbfbfb] px-5 py-3 dark:bg-[#121c2c]",children:[(0,l.jsxs)("div",{className:"text-lg font-bold",children:[m?"Edit":"Add"," Raw Product"]}),(0,l.jsx)("button",{type:"button",className:"text-white-dark hover:text-dark",onClick:()=>a(!1),children:(0,l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,l.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,l.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),(0,l.jsxs)("div",{className:"p-5 space-y-5",children:[(0,l.jsxs)("div",{className:"w-full",children:[(0,l.jsx)("label",{htmlFor:"raw_product_id",children:"Raw Product"}),(0,l.jsx)(n.default,{defaultValue:U[0],value:U.map(e=>e.value===v?e:null),options:U,isSearchable:!0,isClearable:!0,placeholder:"Select Product",onChange:e=>{e&&void 0!==e&&(f(e?parseInt(e.value):0),b(e?e.label:""),w(e?parseFloat(e.unit_price):0),q(e?parseFloat(e.unit_price)*N:0))}})]}),(0,l.jsxs)("div",{className:"w-full",children:[(0,l.jsx)("label",{htmlFor:"raw_product_id",children:"Select Unit"}),(0,l.jsx)(n.default,{defaultValue:I[0],value:I.map(e=>e.value===S?e:null),options:I,isSearchable:!0,isClearable:!0,placeholder:"Select Unit",onChange:e=>{C(e?parseInt(e.value):0),R(e?e.label:"")}})]}),(0,l.jsxs)("div",{className:"w-full",children:[(0,l.jsx)("label",{htmlFor:"raw_product_id",children:"Quantity"}),(0,l.jsx)("input",{type:"number",name:"quantity",className:"form-input",value:N,onChange:e=>g(parseInt(e.target.value))})]}),(0,l.jsxs)("div",{className:"w-full",children:[(0,l.jsx)("label",{htmlFor:"unit_price",children:"Unit Cost"}),(0,l.jsx)("input",{type:"number",name:"unit_price",className:"form-input",value:y,onChange:e=>w(parseFloat(e.target.value))})]}),(0,l.jsxs)("div",{className:"w-full",children:[(0,l.jsx)("label",{htmlFor:"total",children:"Total"}),(0,l.jsx)("input",{type:"number",name:"total",className:"form-input",value:P,onChange:e=>q(parseFloat(e.target.value))})]}),(0,l.jsxs)("div",{className:"w-full",children:[(0,l.jsx)("label",{htmlFor:"description",children:"Description"}),(0,l.jsx)("textarea",{name:"description",className:"form-input",value:F,onChange:e=>k(e.target.value)})]}),(0,l.jsxs)("div",{className:"mt-8 flex items-center justify-end",children:[(0,l.jsx)("button",{type:"button",className:"btn btn-outline-danger",onClick:()=>a(!1),children:"Discard"}),(0,l.jsx)("button",{type:"button",className:"btn btn-primary ltr:ml-4 rtl:mr-4",onClick:()=>d({id:x,raw_product_id:v,raw_product_title:_,unit_id:S,unit_title:E,unit_price:y,quantity:N,total:P,description:F}),children:m?"Update":"Add"})]})]})]})})})})]})})};var x=a(76649),j=a(52481);let v=e=>{let{id:t}=e,a=(0,r.I0)(),{token:c,user:u}=(0,r.v9)(e=>e.user),{loading:o}=(0,r.v9)(e=>e.purchaseRequisition),{code:h}=(0,r.v9)(e=>e.util),[p,v]=(0,i.useState)(!1),[f,_]=(0,i.useState)([]),[b,y]=(0,i.useState)({pr_title:"",pr_code:"",description:"",user_id:0,department_id:0,designation_id:0,requisition_date:"",status:"",items:[]}),[w,N]=(0,i.useState)([{value:"",label:"Select Status"},{value:"Draft",label:"Draft"},{value:"Pending",label:"Proceed"}]),g=e=>{let{name:t,value:a}=e.target;y(e=>({...e,[t]:a}))},S=e=>{_(t=>[...t,e]),v(!1)},C=e=>{let t=f.filter((t,a)=>a!==e);_(t)},E=e=>{e.preventDefault(),(0,s.uB)(c),(0,s.OG)("multipart/form-data"),y(e=>{var t,a;return{...e,user_id:u.id,department_id:null===(t=u.employee)||void 0===t?void 0:t.department_id,designation_id:null===(a=u.employee)||void 0===a?void 0:a.designation_id,items:f.map(e=>({raw_product_id:e.raw_product_id,unit_id:e.unit_id,quantity:e.quantity,unit_price:e.unit_price,total_price:e.total,description:e.description}))}}),t||a((0,d.K1)(b))};return(0,i.useEffect)(()=>{a((0,d.aP)()),(0,s.uB)(c),(0,s.OG)("application/json"),a((0,x.ge)()),a((0,x.bB)(j.q.PURCHASE_REQUISITION))},[]),(0,i.useEffect)(()=>{h&&y(e=>({...e,pr_code:h}))},[h]),(0,l.jsxs)("form",{className:"space-y-5",onSubmit:E,children:[(0,l.jsxs)("div",{className:"flex justify-start flex-col items-start space-y-3",children:[(0,l.jsxs)("div",{className:"w-full md:w-1/3",children:[(0,l.jsx)("label",{htmlFor:"pr_code",children:"Purchase Request Code"}),(0,l.jsx)("input",{id:"pr_code",type:"text",name:"pr_code",placeholder:"Enter Purchase Request Code",value:b.pr_code,onChange:g,disabled:!0,className:"form-input"})]}),(0,l.jsxs)("div",{className:"w-full md:w-1/3",children:[(0,l.jsx)("label",{htmlFor:"requisition_date",children:"Requisition Date"}),(0,l.jsx)("input",{id:"requisition_date",type:"date",name:"requisition_date",placeholder:"Enter Purchase Request Date",value:b.requisition_date,onChange:g,className:"form-input"})]}),(0,l.jsxs)("div",{className:"w-full md:w-1/3",children:[(0,l.jsx)("label",{htmlFor:"status_id",children:"Status"}),(0,l.jsx)(n.default,{defaultValue:w[0],options:w,isSearchable:!0,isClearable:!0,placeholder:"Select Status",onChange:e=>y(t=>({...t,status:e&&void 0!==e?e.value:""}))})]}),(0,l.jsxs)("div",{className:"w-full md:w-1/2",children:[(0,l.jsx)("label",{htmlFor:"pr_title",children:"Purchase Request Name (Optional)"}),(0,l.jsx)("input",{id:"pr_title",type:"text",name:"pr_title",placeholder:"Enter Purchase Request Name",value:b.pr_title,onChange:g,className:"form-input",style:{height:45}})]}),(0,l.jsxs)("div",{className:"table-responsive w-full",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center flex-col md:flex-row space-y-3 md:space-y-0 mb-3",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold",children:"Item Details"}),(0,l.jsx)("button",{type:"button",className:"btn btn-primary btn-sm",onClick:()=>v(!0),children:"Add New Item"})]}),(0,l.jsxs)("table",{children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:"Raw Product"}),(0,l.jsx)("th",{children:"Description"}),(0,l.jsx)("th",{children:"Unit"}),(0,l.jsx)("th",{children:"Quantity"}),(0,l.jsx)("th",{children:"Unit Price"}),(0,l.jsx)("th",{children:"Total"}),(0,l.jsx)("th",{children:"Action"})]})}),(0,l.jsxs)("tbody",{children:[f.map((e,t)=>(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:e.raw_product_title}),(0,l.jsx)("td",{children:e.description}),(0,l.jsx)("td",{children:e.unit_title}),(0,l.jsx)("td",{children:e.quantity}),(0,l.jsx)("td",{children:e.unit_price}),(0,l.jsx)("td",{children:e.total}),(0,l.jsx)("td",{children:(0,l.jsx)("button",{type:"button",onClick:()=>C(t),className:"btn btn-outline-danger btn-sm",children:"Delete"})})]},t)),0===f.length?(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:7,className:"text-center",children:"No Data Found"})}):(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{colSpan:3,className:"text-right font-semibold",children:"Total"}),(0,l.jsx)("td",{children:f.reduce((e,t)=>e+t.quantity,0)}),(0,l.jsx)("td",{children:f.reduce((e,t)=>e+t.unit_price,0)}),(0,l.jsx)("td",{children:f.reduce((e,t)=>e+t.total,0)})]})]})]})]}),(0,l.jsx)("div",{className:"w-full",children:(0,l.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:o,children:o?"Loading...":"Save Purchase Request"})})]}),(0,l.jsx)(m,{modal:p,setModal:v,handleAddRawProduct:e=>S(e)})]})};var f=v},52481:function(e,t,a){var l,i;a.d(t,{q:function(){return l}}),(i=l||(l={})).VENDOR="vendor",i.PURCHASE_REQUISITION="purchase-requisition",i.LOCAL_PURCHASE_ORDER="local-purchase-order",i.GOOD_RECEIVE_NOTE="good-receive-note",i.VENDOR_BILL="vendor-bill",i.PRODUCTION="production",i.PRODUCT_ASSEMBLY="product-assembly",i.EMPLOYEE="employee",i.CUSTOMER="customer",i.RAW_MATERIAL="raw-material"},472:function(e,t,a){a.d(t,{X:function(){return l}});let l=(e,t)=>(e=Math.ceil(e),Math.floor(Math.random()*((t=Math.floor(t))-e+1))+e)}}]);